<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Composites &mdash; pyWaPOR  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/nbsphinx-code-cells.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Enhancing data" href="5_enhancers.html" />
    <link rel="prev" title="Levels" href="2_levels.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #004747" >

          
          
          <a href="../index.html" class="icon icon-home">
            pyWaPOR
              <img src="../_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../data_sources.html">Data</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../_user_guide.html">User Guide</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="1_introduction.html">Introduction</a></li>
<li class="toctree-l2"><a class="reference internal" href="2_levels.html">Levels</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Composites</a></li>
<li class="toctree-l2"><a class="reference internal" href="5_enhancers.html">Enhancing data</a></li>
<li class="toctree-l2"><a class="reference internal" href="6_wapor_vs_pywapor.html">pyWaPOR vs. WaPOR</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../_pywapor_api.html">pyWaPOR API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_etlook.html">ETLook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../bibliography.html">Bibliography</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #004747" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pyWaPOR</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../_user_guide.html">User Guide</a></li>
      <li class="breadcrumb-item active">Composites</li>
      <li class="wy-breadcrumbs-aside">
              <a href="https://bitbucket.org///src/notebooks/3_composites.ipynb?mode=view" class="fa fa-bitbucket"> Edit on Bitbucket</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Composites">
<h1>Composites<a class="headerlink" href="#Composites" title="Permalink to this heading"></a></h1>
<p>In this notebook we’ll take a closer look at how <code class="docutils literal notranslate"><span class="pre">pre_et_look</span></code> works internally. To do so, we’ll be using a couple of functions that you’d normally not need to touch, because they are called automatically when you run <code class="docutils literal notranslate"><span class="pre">pywapor.pre_et_look.main</span></code>.</p>
<p>First, we’ll install pywapor in case it’s not installed yet.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pywapor<span class="w"> </span>--quiet
</pre></div>
</div>
</div>
<p>Then we can define some of the basic parameters that were explained in the introduction notebook. In this case we’ll look at the Fayoum region again, for a period of two months.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pywapor</span>
<span class="kn">import</span> <span class="nn">xarray</span> <span class="k">as</span> <span class="nn">xr</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">project_folder</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;/Users/hmcoerver/pywapor_notebooks_3&quot;</span>
<span class="n">latlim</span> <span class="o">=</span> <span class="p">[</span><span class="mf">28.9</span><span class="p">,</span> <span class="mf">29.7</span><span class="p">]</span>
<span class="n">lonlim</span> <span class="o">=</span> <span class="p">[</span><span class="mf">30.2</span><span class="p">,</span> <span class="mf">31.2</span><span class="p">]</span>
<span class="n">timelim</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;2021-06-01&quot;</span><span class="p">,</span> <span class="s2">&quot;2021-08-01&quot;</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
OMP: Info #276: omp_set_nested routine deprecated, please use omp_set_max_active_levels instead.
</pre></div></div>
</div>
<p>One of the first things happening when you run <code class="docutils literal notranslate"><span class="pre">pre_et_look</span></code>, is the creation of a more precise definition of the composites (from here on also referred to as time_bins) for which <code class="docutils literal notranslate"><span class="pre">pre_et_look</span></code> will prepare the data to be used by <code class="docutils literal notranslate"><span class="pre">et_look</span></code>.</p>
<p>The default value for the <code class="docutils literal notranslate"><span class="pre">bin_length</span></code> in <code class="docutils literal notranslate"><span class="pre">pywapor.pre_et_look.main</span></code> is <code class="docutils literal notranslate"><span class="pre">&quot;DEKAD&quot;</span></code>, which creates three composites per month (of roughly 10 days each), just like much of the WaPOR data. We’ll go with this default value for now. The variable <code class="docutils literal notranslate"><span class="pre">bins</span></code> contains the edges off these bins.</p>
<p>Normally you wouldn’t have to run this code yourself, its just shown here to explain what happens inside the <code class="docutils literal notranslate"><span class="pre">pre_et_look</span></code> code.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bin_length</span> <span class="o">=</span> <span class="s2">&quot;DEKAD&quot;</span>

<span class="n">bins</span> <span class="o">=</span> <span class="n">pywapor</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">compositer</span><span class="o">.</span><span class="n">time_bins</span><span class="p">(</span><span class="n">timelim</span><span class="p">,</span> <span class="n">bin_length</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:])):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Composite </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> starts at </span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2"> and ends at </span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Composite 1 starts at 2021-06-01T00:00:00.000000000 and ends at 2021-06-11T00:00:00.000000000.

Composite 2 starts at 2021-06-11T00:00:00.000000000 and ends at 2021-06-21T00:00:00.000000000.

Composite 3 starts at 2021-06-21T00:00:00.000000000 and ends at 2021-07-01T00:00:00.000000000.

Composite 4 starts at 2021-07-01T00:00:00.000000000 and ends at 2021-07-11T00:00:00.000000000.

Composite 5 starts at 2021-07-11T00:00:00.000000000 and ends at 2021-07-21T00:00:00.000000000.

Composite 6 starts at 2021-07-21T00:00:00.000000000 and ends at 2021-08-01T00:00:00.000000000.

</pre></div></div>
</div>
<p>Besides defining the time_bins, <code class="docutils literal notranslate"><span class="pre">pre_et_look</span></code> also downloads data. In this example we’ll look solely at NDVI data (from MOD13 and MYD13). So instead of using the default (<code class="docutils literal notranslate"><span class="pre">&quot;level_1&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;level_2&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;level_2_v3&quot;</span></code>) <code class="docutils literal notranslate"><span class="pre">sources</span></code>, we’ll define some custom values here. Like this, <code class="docutils literal notranslate"><span class="pre">pre_et_look</span></code> will only process <code class="docutils literal notranslate"><span class="pre">ndvi</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sources</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;ndvi&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;products&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;MODIS&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;product_name&#39;</span><span class="p">:</span> <span class="s1">&#39;MOD13Q1.061&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;enhancers&#39;</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">},</span>
                          <span class="p">{</span><span class="s1">&#39;source&#39;</span><span class="p">:</span> <span class="s1">&#39;MODIS&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;product_name&#39;</span><span class="p">:</span> <span class="s1">&#39;MYD13Q1.061&#39;</span><span class="p">,</span>
                          <span class="s1">&#39;enhancers&#39;</span><span class="p">:</span> <span class="s1">&#39;default&#39;</span><span class="p">}],</span>
            <span class="s1">&#39;composite_type&#39;</span><span class="p">:</span> <span class="s1">&#39;mean&#39;</span><span class="p">,</span>
            <span class="s1">&#39;temporal_interp&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span>
            <span class="s1">&#39;spatial_interp&#39;</span><span class="p">:</span> <span class="s1">&#39;nearest&#39;</span><span class="p">}</span>
        <span class="p">}</span>
</pre></div>
</div>
</div>
<p>Now we can run <code class="docutils literal notranslate"><span class="pre">pre_et_look</span></code>. Since we’ll only download and process <code class="docutils literal notranslate"><span class="pre">ndvi</span></code>, this should go pretty quick.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dss</span><span class="p">,</span> <span class="n">sources</span> <span class="o">=</span> <span class="n">pywapor</span><span class="o">.</span><span class="n">collect</span><span class="o">.</span><span class="n">downloader</span><span class="o">.</span><span class="n">collect_sources</span><span class="p">(</span><span class="n">project_folder</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">latlim</span><span class="p">,</span> <span class="n">lonlim</span><span class="p">,</span> <span class="n">timelim</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
--&gt; Collecting `ndvi` from `MODIS.MOD13Q1.061`.
    --&gt; Applying &#39;mask_qa&#39; to `ndvi`.
    --&gt; Saving merged data.
        &gt; peak-memory-usage: 11.6MB, execution-time: 0:00:02.425868.
        &gt; chunksize|dimsize: [time: 5|5, y: 403|403, x: 506|506]
        &gt; timesize: 5 [2021-06-02T00:00, ..., 2021-08-05T00:00]
--&gt; Collecting `ndvi` from `MODIS.MYD13Q1.061`.
    --&gt; Applying &#39;mask_qa&#39; to `ndvi`.
    --&gt; Saving merged data.
        &gt; peak-memory-usage: 9.3MB, execution-time: 0:00:02.093121.
        &gt; chunksize|dimsize: [time: 4|4, y: 403|403, x: 506|506]
        &gt; timesize: 4 [2021-06-10T00:00, ..., 2021-07-28T00:00]
</pre></div></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">dss</span></code> is a dictionary with the paths to the downloaded netCDF files for each product we’ve requested.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dss</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
{(&#39;MODIS&#39;,
  &#39;MOD13Q1.061&#39;): &#39;/Users/hmcoerver/pywapor_notebooks_3/MODIS/MOD13Q1.061.nc&#39;,
 (&#39;MODIS&#39;,
  &#39;MYD13Q1.061&#39;): &#39;/Users/hmcoerver/pywapor_notebooks_3/MODIS/MYD13Q1.061.nc&#39;}
</pre></div></div>
</div>
<p>We’ll define a function that can plot some values in these datasets at a point of interest.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">plot_timeseries</span><span class="p">(</span><span class="n">dss</span><span class="p">,</span> <span class="n">latlon</span><span class="p">,</span> <span class="n">composites</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">var</span> <span class="o">=</span> <span class="s2">&quot;ndvi&quot;</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;-&quot;</span><span class="p">):</span>
    <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="mi">4</span><span class="p">),</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">composites</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="kc">None</span><span class="p">)):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">composites</span><span class="o">.</span><span class="n">time_bins</span><span class="o">.</span><span class="n">values</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">composites</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">latlon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span> <span class="o">=</span> <span class="n">latlon</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;nearest&quot;</span><span class="p">)[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">width</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">bins</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">width</span> <span class="o">=</span> <span class="n">width</span><span class="p">,</span> <span class="n">align</span> <span class="o">=</span> <span class="s2">&quot;edge&quot;</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="s2">&quot;lightblue&quot;</span><span class="p">,</span> <span class="n">edgecolor</span> <span class="o">=</span> <span class="s2">&quot;darkblue&quot;</span><span class="p">,</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">8</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="mf">0.8</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">product</span><span class="p">,</span> <span class="n">ds_fh</span> <span class="ow">in</span> <span class="n">dss</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="n">ds</span> <span class="o">=</span> <span class="n">xr</span><span class="o">.</span><span class="n">open_dataset</span><span class="p">(</span><span class="n">ds_fh</span><span class="p">,</span> <span class="n">decode_coords</span> <span class="o">=</span> <span class="s2">&quot;all&quot;</span><span class="p">)</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">sel</span><span class="p">(</span><span class="n">y</span> <span class="o">=</span> <span class="n">latlon</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span> <span class="o">=</span> <span class="n">latlon</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">method</span> <span class="o">=</span> <span class="s2">&quot;nearest&quot;</span><span class="p">)[</span><span class="n">var</span><span class="p">]</span><span class="o">.</span><span class="n">values</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">values</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="s2">&quot;.&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">product</span><span class="p">),</span> <span class="n">zorder</span> <span class="o">=</span> <span class="mi">10</span><span class="p">)</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">zorder</span> <span class="o">=</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="s2">&quot;lightgray&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;time&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">var</span><span class="si">}</span><span class="s2"> [</span><span class="si">{</span><span class="n">unit</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>And then use it.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">latlon</span> <span class="o">=</span> <span class="p">(</span><span class="mf">29.32301</span><span class="p">,</span> <span class="mf">30.77599</span><span class="p">)</span>
<span class="n">plot_timeseries</span><span class="p">(</span><span class="n">dss</span><span class="p">,</span> <span class="n">latlon</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_3_composites_16_0.png" src="../_images/notebooks_3_composites_16_0.png" />
</div>
</div>
<p>Next, we’ll run the functions that turns these seperate measurements into composites (again, normally this is done internally when you run <code class="docutils literal notranslate"><span class="pre">pywapor.pre_et_look.main</span></code>). Note that we pass an empty list here for the <code class="docutils literal notranslate"><span class="pre">enhancers</span></code> argument, see the notebook on enhancers to learn more about this argument.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">enhancers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">ds_composites</span> <span class="o">=</span> <span class="n">pywapor</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">compositer</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">dss</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">enhancers</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
--&gt; Compositing 1 variables.
    --&gt; (1/1) Compositing `ndvi` (mean).
        --&gt; Using `MYD13Q1.061.nc` as reprojecting example.
            &gt; shape: (403, 506), res: 0.0020° x 0.0020°.
        --&gt; Saving `ndvi` composites.
            &gt; peak-memory-usage: 58.6MB, execution-time: 0:00:02.029245.
            &gt; chunksize|dimsize: [time_bins: 6|6, y: 403|403, x: 506|506]
--&gt; Didn&#39;t find any products for `is_example`.
--&gt; Creating merged file `et_look_in.nc`.
    &gt; peak-memory-usage: 28.0MB, execution-time: 0:00:02.101097.
    &gt; chunksize|dimsize: [time_bins: 6|6, y: 403|403, x: 506|506]
</pre></div></div>
</div>
<p>You’ll see two messages in the output. They indicate that no example dataset was found. An example dataset is used to make sure the pixel-size and dataset bounds are the same for all variables and products. When no example dataset is found, the function will automatically search for the dataset with the smallest pixels and use that dataset as an example. Since here we are using only two products with a very similar pixel size, this is not very important here.</p>
<p>The output looks like this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_composites</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<div><svg style="position: absolute; width: 0; height: 0; overflow: hidden">
<defs>
<symbol id="icon-database" viewBox="0 0 32 32">
<path d="M16 0c-8.837 0-16 2.239-16 5v4c0 2.761 7.163 5 16 5s16-2.239 16-5v-4c0-2.761-7.163-5-16-5z"></path>
<path d="M16 17c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
<path d="M16 26c-8.837 0-16-2.239-16-5v6c0 2.761 7.163 5 16 5s16-2.239 16-5v-6c0 2.761-7.163 5-16 5z"></path>
</symbol>
<symbol id="icon-file-text2" viewBox="0 0 32 32">
<path d="M28.681 7.159c-0.694-0.947-1.662-2.053-2.724-3.116s-2.169-2.030-3.116-2.724c-1.612-1.182-2.393-1.319-2.841-1.319h-15.5c-1.378 0-2.5 1.121-2.5 2.5v27c0 1.378 1.122 2.5 2.5 2.5h23c1.378 0 2.5-1.122 2.5-2.5v-19.5c0-0.448-0.137-1.23-1.319-2.841zM24.543 5.457c0.959 0.959 1.712 1.825 2.268 2.543h-4.811v-4.811c0.718 0.556 1.584 1.309 2.543 2.268zM28 29.5c0 0.271-0.229 0.5-0.5 0.5h-23c-0.271 0-0.5-0.229-0.5-0.5v-27c0-0.271 0.229-0.5 0.5-0.5 0 0 15.499-0 15.5 0v7c0 0.552 0.448 1 1 1h7v19.5z"></path>
<path d="M23 26h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 22h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
<path d="M23 18h-14c-0.552 0-1-0.448-1-1s0.448-1 1-1h14c0.552 0 1 0.448 1 1s-0.448 1-1 1z"></path>
</symbol>
</defs>
</svg>
<style>/* CSS stylesheet for displaying xarray objects in jupyterlab.
 *
 */

:root {
  --xr-font-color0: var(--jp-content-font-color0, rgba(0, 0, 0, 1));
  --xr-font-color2: var(--jp-content-font-color2, rgba(0, 0, 0, 0.54));
  --xr-font-color3: var(--jp-content-font-color3, rgba(0, 0, 0, 0.38));
  --xr-border-color: var(--jp-border-color2, #e0e0e0);
  --xr-disabled-color: var(--jp-layout-color3, #bdbdbd);
  --xr-background-color: var(--jp-layout-color0, white);
  --xr-background-color-row-even: var(--jp-layout-color1, white);
  --xr-background-color-row-odd: var(--jp-layout-color2, #eeeeee);
}

html[theme=dark],
body[data-theme=dark],
body.vscode-dark {
  --xr-font-color0: rgba(255, 255, 255, 1);
  --xr-font-color2: rgba(255, 255, 255, 0.54);
  --xr-font-color3: rgba(255, 255, 255, 0.38);
  --xr-border-color: #1F1F1F;
  --xr-disabled-color: #515151;
  --xr-background-color: #111111;
  --xr-background-color-row-even: #111111;
  --xr-background-color-row-odd: #313131;
}

.xr-wrap {
  display: block !important;
  min-width: 300px;
  max-width: 700px;
}

.xr-text-repr-fallback {
  /* fallback to plain text repr when CSS is not injected (untrusted notebook) */
  display: none;
}

.xr-header {
  padding-top: 6px;
  padding-bottom: 6px;
  margin-bottom: 4px;
  border-bottom: solid 1px var(--xr-border-color);
}

.xr-header > div,
.xr-header > ul {
  display: inline;
  margin-top: 0;
  margin-bottom: 0;
}

.xr-obj-type,
.xr-array-name {
  margin-left: 2px;
  margin-right: 10px;
}

.xr-obj-type {
  color: var(--xr-font-color2);
}

.xr-sections {
  padding-left: 0 !important;
  display: grid;
  grid-template-columns: 150px auto auto 1fr 20px 20px;
}

.xr-section-item {
  display: contents;
}

.xr-section-item input {
  display: none;
}

.xr-section-item input + label {
  color: var(--xr-disabled-color);
}

.xr-section-item input:enabled + label {
  cursor: pointer;
  color: var(--xr-font-color2);
}

.xr-section-item input:enabled + label:hover {
  color: var(--xr-font-color0);
}

.xr-section-summary {
  grid-column: 1;
  color: var(--xr-font-color2);
  font-weight: 500;
}

.xr-section-summary > span {
  display: inline-block;
  padding-left: 0.5em;
}

.xr-section-summary-in:disabled + label {
  color: var(--xr-font-color2);
}

.xr-section-summary-in + label:before {
  display: inline-block;
  content: '►';
  font-size: 11px;
  width: 15px;
  text-align: center;
}

.xr-section-summary-in:disabled + label:before {
  color: var(--xr-disabled-color);
}

.xr-section-summary-in:checked + label:before {
  content: '▼';
}

.xr-section-summary-in:checked + label > span {
  display: none;
}

.xr-section-summary,
.xr-section-inline-details {
  padding-top: 4px;
  padding-bottom: 4px;
}

.xr-section-inline-details {
  grid-column: 2 / -1;
}

.xr-section-details {
  display: none;
  grid-column: 1 / -1;
  margin-bottom: 5px;
}

.xr-section-summary-in:checked ~ .xr-section-details {
  display: contents;
}

.xr-array-wrap {
  grid-column: 1 / -1;
  display: grid;
  grid-template-columns: 20px auto;
}

.xr-array-wrap > label {
  grid-column: 1;
  vertical-align: top;
}

.xr-preview {
  color: var(--xr-font-color3);
}

.xr-array-preview,
.xr-array-data {
  padding: 0 5px !important;
  grid-column: 2;
}

.xr-array-data,
.xr-array-in:checked ~ .xr-array-preview {
  display: none;
}

.xr-array-in:checked ~ .xr-array-data,
.xr-array-preview {
  display: inline-block;
}

.xr-dim-list {
  display: inline-block !important;
  list-style: none;
  padding: 0 !important;
  margin: 0;
}

.xr-dim-list li {
  display: inline-block;
  padding: 0;
  margin: 0;
}

.xr-dim-list:before {
  content: '(';
}

.xr-dim-list:after {
  content: ')';
}

.xr-dim-list li:not(:last-child):after {
  content: ',';
  padding-right: 5px;
}

.xr-has-index {
  font-weight: bold;
}

.xr-var-list,
.xr-var-item {
  display: contents;
}

.xr-var-item > div,
.xr-var-item label,
.xr-var-item > .xr-var-name span {
  background-color: var(--xr-background-color-row-even);
  margin-bottom: 0;
}

.xr-var-item > .xr-var-name:hover span {
  padding-right: 5px;
}

.xr-var-list > li:nth-child(odd) > div,
.xr-var-list > li:nth-child(odd) > label,
.xr-var-list > li:nth-child(odd) > .xr-var-name span {
  background-color: var(--xr-background-color-row-odd);
}

.xr-var-name {
  grid-column: 1;
}

.xr-var-dims {
  grid-column: 2;
}

.xr-var-dtype {
  grid-column: 3;
  text-align: right;
  color: var(--xr-font-color2);
}

.xr-var-preview {
  grid-column: 4;
}

.xr-index-preview {
  grid-column: 2 / 5;
  color: var(--xr-font-color2);
}

.xr-var-name,
.xr-var-dims,
.xr-var-dtype,
.xr-preview,
.xr-attrs dt {
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  padding-right: 10px;
}

.xr-var-name:hover,
.xr-var-dims:hover,
.xr-var-dtype:hover,
.xr-attrs dt:hover {
  overflow: visible;
  width: auto;
  z-index: 1;
}

.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  display: none;
  background-color: var(--xr-background-color) !important;
  padding-bottom: 5px !important;
}

.xr-var-attrs-in:checked ~ .xr-var-attrs,
.xr-var-data-in:checked ~ .xr-var-data,
.xr-index-data-in:checked ~ .xr-index-data {
  display: block;
}

.xr-var-data > table {
  float: right;
}

.xr-var-name span,
.xr-var-data,
.xr-index-name div,
.xr-index-data,
.xr-attrs {
  padding-left: 25px !important;
}

.xr-attrs,
.xr-var-attrs,
.xr-var-data,
.xr-index-data {
  grid-column: 1 / -1;
}

dl.xr-attrs {
  padding: 0;
  margin: 0;
  display: grid;
  grid-template-columns: 125px auto;
}

.xr-attrs dt,
.xr-attrs dd {
  padding: 0;
  margin: 0;
  float: left;
  padding-right: 10px;
  width: auto;
}

.xr-attrs dt {
  font-weight: normal;
  grid-column: 1;
}

.xr-attrs dt:hover span {
  display: inline-block;
  background: var(--xr-background-color);
  padding-right: 10px;
}

.xr-attrs dd {
  grid-column: 2;
  white-space: pre-wrap;
  word-break: break-all;
}

.xr-icon-database,
.xr-icon-file-text2,
.xr-no-icon {
  display: inline-block;
  vertical-align: middle;
  width: 1em;
  height: 1.5em !important;
  stroke-width: 0;
  stroke: currentColor;
  fill: currentColor;
}
</style><pre class='xr-text-repr-fallback'>&lt;xarray.Dataset&gt;
Dimensions:      (time_bins: 6, y: 403, x: 506)
Coordinates:
  * x            (x) float64 30.2 30.2 30.2 30.21 30.21 ... 31.19 31.2 31.2 31.2
  * y            (y) float64 29.7 29.7 29.7 29.69 ... 28.91 28.91 28.9 28.9
    spatial_ref  int64 ...
  * time_bins    (time_bins) datetime64[ns] 2021-06-01 2021-06-11 ... 2021-07-21
Data variables:
    ndvi         (time_bins, y, x) float64 dask.array&lt;chunksize=(6, 403, 506), meta=np.ndarray&gt;</pre><div class='xr-wrap' style='display:none'><div class='xr-header'><div class='xr-obj-type'>xarray.Dataset</div></div><ul class='xr-sections'><li class='xr-section-item'><input id='section-e9410938-b4fa-4483-be69-0a793d6fafc0' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-e9410938-b4fa-4483-be69-0a793d6fafc0' class='xr-section-summary'  title='Expand/collapse section'>Dimensions:</label><div class='xr-section-inline-details'><ul class='xr-dim-list'><li><span class='xr-has-index'>time_bins</span>: 6</li><li><span class='xr-has-index'>y</span>: 403</li><li><span class='xr-has-index'>x</span>: 506</li></ul></div><div class='xr-section-details'></div></li><li class='xr-section-item'><input id='section-44645999-33e2-4176-b1a4-dfbf9fe64035' class='xr-section-summary-in' type='checkbox'  checked><label for='section-44645999-33e2-4176-b1a4-dfbf9fe64035' class='xr-section-summary' >Coordinates: <span>(4)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>x</span></div><div class='xr-var-dims'>(x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>30.2 30.2 30.2 ... 31.2 31.2 31.2</div><input id='attrs-766ec904-9866-4c5a-a16b-2932d4ac8332' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-766ec904-9866-4c5a-a16b-2932d4ac8332' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-764c471b-e774-4a31-96a1-df32e08f4ce6' class='xr-var-data-in' type='checkbox'><label for='data-764c471b-e774-4a31-96a1-df32e08f4ce6' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>X</dd><dt><span>long_name :</span></dt><dd>longitude</dd><dt><span>standard_name :</span></dt><dd>longitude</dd><dt><span>units :</span></dt><dd>degrees_east</dd></dl></div><div class='xr-var-data'><pre>array([30.199116, 30.201099, 30.203082, ..., 31.196461, 31.198443, 31.200426])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>y</span></div><div class='xr-var-dims'>(y)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>29.7 29.7 29.7 ... 28.91 28.9 28.9</div><input id='attrs-de7a116d-6011-4c67-8193-4b9ff5690452' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-de7a116d-6011-4c67-8193-4b9ff5690452' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-57da6740-3d26-4421-beca-b31b679e0784' class='xr-var-data-in' type='checkbox'><label for='data-57da6740-3d26-4421-beca-b31b679e0784' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>axis :</span></dt><dd>Y</dd><dt><span>long_name :</span></dt><dd>latitude</dd><dt><span>standard_name :</span></dt><dd>latitude</dd><dt><span>units :</span></dt><dd>degrees_north</dd></dl></div><div class='xr-var-data'><pre>array([29.70005 , 29.698067, 29.696085, ..., 28.906933, 28.904951, 28.902968])</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span>spatial_ref</span></div><div class='xr-var-dims'>()</div><div class='xr-var-dtype'>int64</div><div class='xr-var-preview xr-preview'>...</div><input id='attrs-2b72a146-fe19-45ef-a51d-2ee79e5e0883' class='xr-var-attrs-in' type='checkbox' ><label for='attrs-2b72a146-fe19-45ef-a51d-2ee79e5e0883' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-2dd4d436-29ca-42e4-9d5e-5429d6439de2' class='xr-var-data-in' type='checkbox'><label for='data-2dd4d436-29ca-42e4-9d5e-5429d6439de2' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'><dt><span>crs_wkt :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>semi_major_axis :</span></dt><dd>6378137.0</dd><dt><span>semi_minor_axis :</span></dt><dd>6356752.314245179</dd><dt><span>inverse_flattening :</span></dt><dd>298.257223563</dd><dt><span>reference_ellipsoid_name :</span></dt><dd>WGS 84</dd><dt><span>longitude_of_prime_meridian :</span></dt><dd>0.0</dd><dt><span>prime_meridian_name :</span></dt><dd>Greenwich</dd><dt><span>geographic_crs_name :</span></dt><dd>WGS 84</dd><dt><span>grid_mapping_name :</span></dt><dd>latitude_longitude</dd><dt><span>spatial_ref :</span></dt><dd>GEOGCS[&quot;WGS 84&quot;,DATUM[&quot;WGS_1984&quot;,SPHEROID[&quot;WGS 84&quot;,6378137,298.257223563,AUTHORITY[&quot;EPSG&quot;,&quot;7030&quot;]],AUTHORITY[&quot;EPSG&quot;,&quot;6326&quot;]],PRIMEM[&quot;Greenwich&quot;,0,AUTHORITY[&quot;EPSG&quot;,&quot;8901&quot;]],UNIT[&quot;degree&quot;,0.0174532925199433,AUTHORITY[&quot;EPSG&quot;,&quot;9122&quot;]],AXIS[&quot;Latitude&quot;,NORTH],AXIS[&quot;Longitude&quot;,EAST],AUTHORITY[&quot;EPSG&quot;,&quot;4326&quot;]]</dd><dt><span>GeoTransform :</span></dt><dd>30.198124670407314 0.001982792281130139 0.0 29.70104166399938 0.0 -0.001982792281130138</dd></dl></div><div class='xr-var-data'><pre>[1 values with dtype=int64]</pre></div></li><li class='xr-var-item'><div class='xr-var-name'><span class='xr-has-index'>time_bins</span></div><div class='xr-var-dims'>(time_bins)</div><div class='xr-var-dtype'>datetime64[ns]</div><div class='xr-var-preview xr-preview'>2021-06-01 ... 2021-07-21</div><input id='attrs-f45b78b3-3ee9-4fb8-9672-8d13c33895f9' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-f45b78b3-3ee9-4fb8-9672-8d13c33895f9' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-91782dc1-c672-465b-8a7f-5d2c9751886e' class='xr-var-data-in' type='checkbox'><label for='data-91782dc1-c672-465b-8a7f-5d2c9751886e' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><pre>array([&#x27;2021-06-01T00:00:00.000000000&#x27;, &#x27;2021-06-11T00:00:00.000000000&#x27;,
       &#x27;2021-06-21T00:00:00.000000000&#x27;, &#x27;2021-07-01T00:00:00.000000000&#x27;,
       &#x27;2021-07-11T00:00:00.000000000&#x27;, &#x27;2021-07-21T00:00:00.000000000&#x27;],
      dtype=&#x27;datetime64[ns]&#x27;)</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-806a603e-f795-474d-936e-bcaae5c0a73f' class='xr-section-summary-in' type='checkbox'  checked><label for='section-806a603e-f795-474d-936e-bcaae5c0a73f' class='xr-section-summary' >Data variables: <span>(1)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-var-name'><span>ndvi</span></div><div class='xr-var-dims'>(time_bins, y, x)</div><div class='xr-var-dtype'>float64</div><div class='xr-var-preview xr-preview'>dask.array&lt;chunksize=(6, 403, 506), meta=np.ndarray&gt;</div><input id='attrs-44310a13-9b1e-493f-9ef6-5e86c289a838' class='xr-var-attrs-in' type='checkbox' disabled><label for='attrs-44310a13-9b1e-493f-9ef6-5e86c289a838' title='Show/Hide attributes'><svg class='icon xr-icon-file-text2'><use xlink:href='#icon-file-text2'></use></svg></label><input id='data-292a55d6-84d5-40a8-9469-06c05febb6f3' class='xr-var-data-in' type='checkbox'><label for='data-292a55d6-84d5-40a8-9469-06c05febb6f3' title='Show/Hide data repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-var-attrs'><dl class='xr-attrs'></dl></div><div class='xr-var-data'><table>
    <tr>
        <td>
            <table style="border-collapse: collapse;">
                <thead>
                    <tr>
                        <td> </td>
                        <th> Array </th>
                        <th> Chunk </th>
                    </tr>
                </thead>
                <tbody>

                    <tr>
                        <th> Bytes </th>
                        <td> 9.33 MiB </td>
                        <td> 9.33 MiB </td>
                    </tr>

                    <tr>
                        <th> Shape </th>
                        <td> (6, 403, 506) </td>
                        <td> (6, 403, 506) </td>
                    </tr>
                    <tr>
                        <th> Dask graph </th>
                        <td colspan="2"> 1 chunks in 2 graph layers </td>
                    </tr>
                    <tr>
                        <th> Data type </th>
                        <td colspan="2"> float64 numpy.ndarray </td>
                    </tr>
                </tbody>
            </table>
        </td>
        <td>
        <svg width="195" height="161" style="stroke:rgb(0,0,0);stroke-width:1" >

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="10" y1="95" x2="25" y2="111" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="10" y2="95" style="stroke-width:2" />
  <line x1="25" y1="15" x2="25" y2="111" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 25.439388221553124,15.439388221553125 25.439388221553124,111.0125107511974 10.0,95.57312252964427" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="10" y1="0" x2="130" y2="0" style="stroke-width:2" />
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="10" y1="0" x2="25" y2="15" style="stroke-width:2" />
  <line x1="130" y1="0" x2="145" y2="15" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="10.0,0.0 130.0,0.0 145.43938822155312,15.439388221553125 25.439388221553124,15.439388221553125" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Horizontal lines -->
  <line x1="25" y1="15" x2="145" y2="15" style="stroke-width:2" />
  <line x1="25" y1="111" x2="145" y2="111" style="stroke-width:2" />

  <!-- Vertical lines -->
  <line x1="25" y1="15" x2="25" y2="111" style="stroke-width:2" />
  <line x1="145" y1="15" x2="145" y2="111" style="stroke-width:2" />

  <!-- Colored Rectangle -->
  <polygon points="25.439388221553124,15.439388221553125 145.43938822155312,15.439388221553125 145.43938822155312,111.0125107511974 25.439388221553124,111.0125107511974" style="fill:#ECB172A0;stroke-width:0"/>

  <!-- Text -->
  <text x="85.439388" y="131.012511" font-size="1.0rem" font-weight="100" text-anchor="middle" >506</text>
  <text x="165.439388" y="63.225949" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(-90,165.439388,63.225949)">403</text>
  <text x="7.719694" y="123.292817" font-size="1.0rem" font-weight="100" text-anchor="middle" transform="rotate(45,7.719694,123.292817)">6</text>
</svg>
        </td>
    </tr>
</table></div></li></ul></div></li><li class='xr-section-item'><input id='section-c7bda89c-ec76-4065-bec2-6c6026b99301' class='xr-section-summary-in' type='checkbox'  ><label for='section-c7bda89c-ec76-4065-bec2-6c6026b99301' class='xr-section-summary' >Indexes: <span>(3)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><ul class='xr-var-list'><li class='xr-var-item'><div class='xr-index-name'><div>x</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-b99afccd-0578-4282-a88f-c2e2d28055a5' class='xr-index-data-in' type='checkbox'/><label for='index-b99afccd-0578-4282-a88f-c2e2d28055a5' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([ 30.19911606654788, 30.201098858829013, 30.203081651110143,
              30.205064443391272, 30.207047235672402,  30.20903002795353,
              30.211012820234664, 30.212995612515794, 30.214978404796923,
              30.216961197078053,
              ...
               31.18258103798843,  31.18456383026956,  31.18654662255069,
               31.18852941483182,  31.19051220711295,  31.19249499939408,
               31.19447779167521,  31.19646058395634,  31.19844337623747,
                31.2004261685186],
             dtype=&#x27;float64&#x27;, name=&#x27;x&#x27;, length=506))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>y</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-cd3e401d-a4d4-4ebb-8ca6-e22284394290' class='xr-index-data-in' type='checkbox'/><label for='index-cd3e401d-a4d4-4ebb-8ca6-e22284394290' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(Float64Index([29.700050267858813, 29.698067475577684, 29.696084683296554,
               29.69410189101542, 29.692119098734292, 29.690136306453162,
              29.688153514172033, 29.686170721890903, 29.684187929609774,
               29.68220513732864,
              ...
               28.92081290137467,  28.91883010909354, 28.916847316812408,
               28.91486452453128,  28.91288173225015,  28.91089893996902,
               28.90891614768789,  28.90693335540676, 28.904950563125627,
              28.902967770844498],
             dtype=&#x27;float64&#x27;, name=&#x27;y&#x27;, length=403))</pre></div></li><li class='xr-var-item'><div class='xr-index-name'><div>time_bins</div></div><div class='xr-index-preview'>PandasIndex</div><div></div><input id='index-22728b12-acad-4de0-8e32-c43be55c1b1a' class='xr-index-data-in' type='checkbox'/><label for='index-22728b12-acad-4de0-8e32-c43be55c1b1a' title='Show/Hide index repr'><svg class='icon xr-icon-database'><use xlink:href='#icon-database'></use></svg></label><div class='xr-index-data'><pre>PandasIndex(DatetimeIndex([&#x27;2021-06-01&#x27;, &#x27;2021-06-11&#x27;, &#x27;2021-06-21&#x27;, &#x27;2021-07-01&#x27;,
               &#x27;2021-07-11&#x27;, &#x27;2021-07-21&#x27;],
              dtype=&#x27;datetime64[ns]&#x27;, name=&#x27;time_bins&#x27;, freq=None))</pre></div></li></ul></div></li><li class='xr-section-item'><input id='section-9776d74c-c2c3-4374-baeb-136607d83c55' class='xr-section-summary-in' type='checkbox' disabled ><label for='section-9776d74c-c2c3-4374-baeb-136607d83c55' class='xr-section-summary'  title='Expand/collapse section'>Attributes: <span>(0)</span></label><div class='xr-section-inline-details'></div><div class='xr-section-details'><dl class='xr-attrs'></dl></div></li></ul></div></div></div>
</div>
<p>We can make a plot like this.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_timeseries</span><span class="p">(</span><span class="n">dss</span><span class="p">,</span> <span class="n">latlon</span><span class="p">,</span> <span class="n">composites</span> <span class="o">=</span> <span class="n">ds_composites</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_3_composites_22_0.png" src="../_images/notebooks_3_composites_22_0.png" />
</div>
</div>
<p>In the graph we have just created, you should see a couple of things. First of all, there are blue-dots and orange-dots that show available NDVI measurements at our POI, coming from MOD13 and MYD13 respectively. Then there are blue bars that show the composite pixel values at this location. Since our composites are dekadal, the width of the bars is about 10 days (check the x-axis).</p>
<p>Each composite value is the mean of the available measurements within the respective <code class="docutils literal notranslate"><span class="pre">time_bin</span></code>. For example, most of the bars match with some of the measurements. While the first bar, ranging from June 1st till June 11th is exactly in between two measurements, i.e. it’s the mean of the two available measurements.</p>
<p>The composite type is defined using the keyword <code class="docutils literal notranslate"><span class="pre">composite_type</span></code> in the sources variable. Possible values are <code class="docutils literal notranslate"><span class="pre">&quot;mean&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;min&quot;</span></code> and <code class="docutils literal notranslate"><span class="pre">&quot;max&quot;</span></code>.</p>
<p>Now let’s adjust our composite_length to create 6-day composites (instead of dekadal) and see what happens.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">bin_length</span> <span class="o">=</span> <span class="mi">6</span>
<span class="n">bins</span> <span class="o">=</span> <span class="n">pywapor</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">compositer</span><span class="o">.</span><span class="n">time_bins</span><span class="p">(</span><span class="n">timelim</span><span class="p">,</span> <span class="n">bin_length</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="p">(</span><span class="n">start</span><span class="p">,</span> <span class="n">end</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">bins</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">bins</span><span class="p">[</span><span class="mi">1</span><span class="p">:])):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Composite </span><span class="si">{</span><span class="n">i</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="si">}</span><span class="s2"> starts at </span><span class="si">{</span><span class="n">start</span><span class="si">}</span><span class="s2"> and ends at </span><span class="si">{</span><span class="n">end</span><span class="si">}</span><span class="s2">.</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Composite 1 starts at 2021-06-01T00:00:00.000000000 and ends at 2021-06-07T00:00:00.000000000.

Composite 2 starts at 2021-06-07T00:00:00.000000000 and ends at 2021-06-13T00:00:00.000000000.

Composite 3 starts at 2021-06-13T00:00:00.000000000 and ends at 2021-06-19T00:00:00.000000000.

Composite 4 starts at 2021-06-19T00:00:00.000000000 and ends at 2021-06-25T00:00:00.000000000.

Composite 5 starts at 2021-06-25T00:00:00.000000000 and ends at 2021-07-01T00:00:00.000000000.

Composite 6 starts at 2021-07-01T00:00:00.000000000 and ends at 2021-07-07T00:00:00.000000000.

Composite 7 starts at 2021-07-07T00:00:00.000000000 and ends at 2021-07-13T00:00:00.000000000.

Composite 8 starts at 2021-07-13T00:00:00.000000000 and ends at 2021-07-19T00:00:00.000000000.

Composite 9 starts at 2021-07-19T00:00:00.000000000 and ends at 2021-07-25T00:00:00.000000000.

Composite 10 starts at 2021-07-25T00:00:00.000000000 and ends at 2021-07-31T00:00:00.000000000.

Composite 11 starts at 2021-07-31T00:00:00.000000000 and ends at 2021-08-06T00:00:00.000000000.

</pre></div></div>
</div>
<p>And then recalculate the composites.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ds_composites</span> <span class="o">=</span> <span class="n">pywapor</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">compositer</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">dss</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">enhancers</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
--&gt; Compositing 1 variables.
    --&gt; (1/1) Compositing `ndvi` (mean).
        --&gt; Using `MYD13Q1.061.nc` as reprojecting example.
            &gt; shape: (403, 506), res: 0.0020° x 0.0020°.
        --&gt; Saving `ndvi` composites.
            &gt; peak-memory-usage: 80.9MB, execution-time: 0:00:02.039768.
            &gt; chunksize|dimsize: [time_bins: 11|11, y: 403|403, x: 506|506]
--&gt; Didn&#39;t find any products for `is_example`.
--&gt; Creating merged file `et_look_in_.nc`.
    &gt; peak-memory-usage: 51.3MB, execution-time: 0:00:02.143718.
    &gt; chunksize|dimsize: [time_bins: 11|11, y: 403|403, x: 506|506]
</pre></div></div>
</div>
<p>Then create a new plot.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_timeseries</span><span class="p">(</span><span class="n">dss</span><span class="p">,</span> <span class="n">latlon</span><span class="p">,</span> <span class="n">composites</span> <span class="o">=</span> <span class="n">ds_composites</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_3_composites_28_0.png" src="../_images/notebooks_3_composites_28_0.png" />
</div>
</div>
<p>In the new graph, you’ll see that the blue bars have become smaller (i.e. less wide), since our time_bins are now shorter. As a result, some composites could not be created, because no NDVI measurements were available during that respective epoch. For example, the fourth composite (ranging between 2021-06-19 00:00:00 and 2021-06-25 00:00:00) is missing.</p>
<p>We solve this by applying a temporal interpolation between the available measurements. This is especially suitable for this data, because the MOD13 and MYD13 datasets itself are 16-daily composites, i.e. their measurements can be considered valid for a 16-day period.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sources</span><span class="p">[</span><span class="s2">&quot;ndvi&quot;</span><span class="p">][</span><span class="s2">&quot;temporal_interp&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;linear&quot;</span>
<span class="n">ds_composites</span> <span class="o">=</span> <span class="n">pywapor</span><span class="o">.</span><span class="n">general</span><span class="o">.</span><span class="n">compositer</span><span class="o">.</span><span class="n">main</span><span class="p">(</span><span class="n">dss</span><span class="p">,</span> <span class="n">sources</span><span class="p">,</span> <span class="n">project_folder</span><span class="p">,</span> <span class="n">enhancers</span><span class="p">,</span> <span class="n">bins</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
--&gt; Compositing 1 variables.
    --&gt; (1/1) Compositing `ndvi` (mean).
        --&gt; Using `MYD13Q1.061.nc` as reprojecting example.
            &gt; shape: (403, 506), res: 0.0020° x 0.0020°.
        --&gt; Saving `ndvi` composites.
            &gt; peak-memory-usage: 82.5MB, execution-time: 0:00:06.065150.
            &gt; chunksize|dimsize: [time_bins: 11|11, y: 403|403, x: 506|506]
--&gt; Didn&#39;t find any products for `is_example`.
--&gt; Creating merged file `et_look_in__.nc`.
    &gt; peak-memory-usage: 51.3MB, execution-time: 0:00:02.173311.
    &gt; chunksize|dimsize: [time_bins: 11|11, y: 403|403, x: 506|506]
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plot_timeseries</span><span class="p">(</span><span class="n">dss</span><span class="p">,</span> <span class="n">latlon</span><span class="p">,</span> <span class="n">composites</span> <span class="o">=</span> <span class="n">ds_composites</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_3_composites_31_0.png" src="../_images/notebooks_3_composites_31_0.png" />
</div>
</div>
<p>The two composites that were previously missing are now there! Note that although here we are looking at one pixel, these interpolations are done for the entire domain.</p>
<p>Possible values for temporal_interp are <code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;linear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;nearest&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;zero&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;slinear&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;quadratic&quot;</span></code> or <code class="docutils literal notranslate"><span class="pre">&quot;cubic&quot;</span></code>. But be aware that some of these can be computationally heavy.</p>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="2_levels.html" class="btn btn-neutral float-left" title="Levels" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="5_enhancers.html" class="btn btn-neutral float-right" title="Enhancing data" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, FAO.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>